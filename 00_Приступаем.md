## Инструкция по установке


## Доступ в админку

Имя пользователя: developer

Пароль: спросить у разработчика


## Работа с исходным js-, css- кодом

ВАЖНО ЗАПОМНИТЬ, что все файлы, лежащие в папке www/assets (за исключением подпапки components/) МЫ НИКОГДА ВРУЧНУЮ НЕ РЕДАКТИРУЕМ!!!
Вместо этого необходимо открыть папку source/, запустить gulp-task "watch" из файла gulp_production.js и редактировать исходные коды в папке source/assets

## Работа с иходным кодом чанков/сниппетов/плагинов, настройками контекста и системными настройками

ВАЖНО ЗАПОМНИТЬ, что мы не редактируем (и не создаем) чанки/плагины/сниппеты/настройки контекста/настройки системы через админку в базе данных, чтобы упростить версионный контроль файлов!
Наша сборка modx позволяет создавать все эти сущности, создавая файлы в каталоге:
1. www/core/components/gitmodx/config - для настроек системы
2. www/core/components/gitmodx/config/web - для настроек контекста web (для других контекстов нужно создать соответствующие папки внутри каталога config)
3. www/core/components/gitmodx/elements - для чанков, сниппетов и плагинов (каждая сущность в своей подпапке)


## Создание новых шаблонов

С шаблонами дело обстоит немного иначе, по сравнению с чанками/сниппетами/плагинами.
Шаблон необходимо создать сначала в папке www/core/components/gitmodx/elements/templates (например my_template.tpl)
Затем необходимо создать его через админку, сделав его статичным и привязав его к только что созданному файлу


## Инструкции по добавлению новых коммитов

### Ветвление

Каждую свою выполняемую задачу или набор задач помечайте в Trello префиксом fix_YYMMDD или feature_YYMMDD и под эти задачи создавайте отдельную ветку с таким же названием.
Например, у вас в Trello висит две задачи по добавлению нового функционала, вы хотите их выполнить в рамках одной ветки. Переименуйте карточки с задачами, добавив спереди к названию карточки feature_170113, затем ответвитесь от основной ветки разработки, создав ветвь feature_170113
После того, как вы выполнили все в рамках этих задач, сделайте коммит в свою ветвь и затем слейте эту ветвь в основную ветвь разработки.

Примечание: если вы выполняете задачу, связанную с разработкой нового функционала - название ветви должно начинаться на feature_, если же вы устраняете ошибку в уже разработанном функционале, то название ветви должно начинаться на fix_

### Контроль config-файлов:

Не забывайте, что файл www/core/config/config.inc.php и каталог www/core/components/gitmodx/config не попадают в репозиторий, так как носят индивидуальный характер для каждой отдельной рабочей станции.
ПОЭТОМУ, перед коммитом посмотрите, добавляли ли вы какие-то новые настройки в свой config-файл или несколько config-файлов. Если да, то продублируйте свои изменения в файл config.sample.inc.php и каталог config.sample
ЧТОБЫ не забывать об этом каждый раз, просто перед коммитов дублируйте содержимое своих конфиг-файлов и каталогов в файл config.sample.inc.php и каталог config.sample

### Контроль базы данных:

Идеальный способ учитывать изменения в базе данных при создании коммитов - это запуск скрипта db/db_backup.php
Он создаст все необходимые файлы в папках dbdata, dbstructure и dbsample и потом при помощи утилиты сравнения можно легко увидеть, какие таблицы были изменены (в плане данных и структуры)


## Именование чанков

При разработке новых компонентов в процессе редактирования кода шаблонов, периодически приходится разбивать код на чанки.
Создавая новый чанк, стоит подумать, какую сущность он представляет:
1. Блок.
2. Элемент

### Именование блоков

Если создаваемый чанк представляет собой самостоятельный блок.

Создавайте файл в подпапке www/core/components/gitmodx/elements/chunks/blocks с названием b.имясущности.tpl

Имя сущности определяется либо именем класса блока, либо другими словами, обозначающими назначение этог блока.

Например, если это блок товара в списке товаров:
`b.productItem.tpl`


### Именование элементов

Если создаваемый чанк не представляет собой самостоятельный блок, а может быть использован только внутри другого самостоятельного блока.

Создавайте файл в подпапке www/core/components/gitmodx/elements/chunks/elements с названием e.имясущности.tpl

Имя сущности определяется либо именем класса элемента, либо другими словами, обозначающими назначение этого элемента.

Например, если это один элемент в хлебных крошках:
`e.breadCrumbItem.tpl`


### Группировка по подпапкам

Если в рамках какого-либо блока или страницы набирается достаточное количество
новых чанков, то их можно группировать по подпапкам.

Например, если у вас имеется 5 чанков-блоков для отображения товаров и их отдельных элементов,
то можно создать подпапку

`www/core/components/gitmodx/elements/chunks/product`

или

`www/core/components/gitmodx/elements/chunks/blocks/product`
`www/core/components/gitmodx/elements/chunks/elements/product`

и внутри них создавать все необходимые чанки


## Работа с ID ресурсов в базе данных

При использовании где либо идентификаторов ресурсов - будь то код сниппета, чанка или шаблона, в подавляющем большинстве случаев необходимо создать настройку в конфигурационном файле и в коде использовать ID через настройку.

Например, нам необходимо вывести список категорий товаров. Общий родитель для всех категорий - это ресурс с ID = 5.

Вместо вызова сниппета с параметром `parent => 5` необходимо в файле www/core/components/gitmodx/config/myproject.inc.php создать настройку:

`'my_project_products_parent' => 5`

и далее например в чанке:

```
{$_modx->runSnippet('pdoResources',[
...
'parents' => $_modx->config.my_project_products_parent,
...
])}
```

или где-то в коде другого сниппета:

```
$parent = $modx->getOption('my_project_products_parent');
```

Такой подход позволит при разворачивании проекта на новой рабочей станции, обозначить все опорные ресурсы один раз в конфиг-файле, избегая многократного исправления кода чанков/сниппетов/шаблонов (если бы мы использовали ID напрямую)