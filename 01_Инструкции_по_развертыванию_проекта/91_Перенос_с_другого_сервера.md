## Инструкция по переносу сайта с другого сервера

Предполагается, что переносимый сайт находится в git-репозитории

### Разворачивание на новом сервере

После того, как вы выполнили все [инструкции по развертыванию сервера](90_Полная_инструкция_по_развертыванию_на_Ubuntu.md) необходимо
проверить работоспособность сайта на новом сервере.

Убедившись в том, что сайт открывается на новом сервере, далее необходимо выполнить 2 дополнительных действия:

### 1. Перенос игнорируемых файлов

Поскольку проект существовал и функционировал на первом сервере, не исключено, что за время его жизни
администратор загружал новые данные через админку, в частности изображения и какие-то дополнительные файлы, поэтому
вам необходимо подключиться к первому серверу, зайти в основной каталог сайта:

```
cd /home/[your_user]/[your_site_name]
```

После этого посмотрите содержимое файла .gitignore и заархивируйте все папки с важными данными (папку cache можно исключить):

```
zip -r ignored.zip www/images www/assets/images [дополнительные папки через пробел]
```

Полученный файл ignored.zip поместите в папку /home/[your_user]/[your_site_name] на новом сервере, распакуйте и удалите:

```
unzip ignored.zip; rm ignored.zip
```

### 2. Перенос базы данных

Поскольку база на production-сервере время от времени обновляется за счет действий администратора,
работающего через админку, ее необходимо также переносить вручную с первого сервера.

Сначала, подключившись к первому серверу, выполните команду:

```
mysqldump --add-drop-table --allow-keywords --create-options -e -q -c -u [your_db_user] -h localhost -p [your_db_name] > first_server_db.sql
```

После запуска команды, введите пароль для подключения к БД.

После успешного выполнения вы получите файл first_server_db.sql

Переместите его на новый сервер и запустите там следующую команду:

```
mysql -u [your_db_user] -p [your_db_name] < first_server_db.sql
```

После запуска команды введите пароль для подключения к БД.

При успешном выполнении, на втором сервере вы будете иметь идентичное с первым сервером состояние базы данных.